---
title: 斐波那契堆：一种高效的优先队列
tags: [heap, 数据结构]
categories: [数据结构]
abbrlink: 'fibonacci-heap'
date: 2024-12-24 09:39:25
updated: 2024-12-24 09:39:25
---

### 斐波那契堆是什么？

斐波那契堆是一种特殊的堆数据结构，它在插入、删除最小值、合并等操作上具有非常优秀的均摊时间复杂度。与传统的二项堆相比，斐波那契堆在某些操作上表现得更加高效。

### 斐波那契堆的结构

* **最小堆的集合:** 斐波那契堆实际上是一组最小堆的集合。每个堆是一棵树，且满足最小堆的性质（即每个节点的值都大于等于其父节点的值）。
* **根链表:** 所有树的根节点通过双向链表连接起来，形成一个根链表。
* **度:** 每个节点的度定义为其子节点的数量。
* **标记:** 每个节点有一个标记位，用于延迟减少树的度数的操作。

### 斐波那契堆的操作

* **插入:** 将新节点插入到根链表中。
* **查找最小值:** 从根链表中找到最小节点。
* **删除最小值:** 删除最小节点，并将它的子节点加入到根链表中。
* **减小关键字:** 减少一个节点的关键字，如果违反了最小堆的性质，则进行一系列的切割和合并操作。
* **合并:** 将两个斐波那契堆合并成一个。

### 斐波那契堆的时间复杂度

斐波那契堆的许多操作都具有常数的**摊还时间复杂度**。这意味着一系列操作的总时间复杂度是有界的，即使单个操作可能需要较长时间。

| 操作 | 最坏情况时间复杂度 | 均摊时间复杂度 |
|---|---|---|
| 插入 | O(1) | O(1) |
| 查找最小值 | O(1) | O(1) |
| 删除最小值 | O(log n) | O(log n) |
| 减小关键字 | O(log n) | O(1) |
| 合并 | O(1) | O(1) |

### 斐波那契堆的应用

* **Dijkstra算法:** 斐波那契堆可以用来优化Dijkstra算法，使得算法的运行时间从O(V^2)降低到O(E + VlogV)。
* **Prim算法:** 斐波那契堆也可以用来优化Prim算法，用于求最小生成树。
* **其他贪心算法:** 许多贪心算法都可以受益于斐波那契堆的高效性。

### 为什么叫斐波那契堆？

斐波那契堆的名字来源于对堆中树的度数的分析。可以证明，在斐波那契堆中，度为k的树的节点数至少是斐波那契数F(k+2)。

### 总结

斐波那契堆是一种非常高效的优先队列数据结构，它在许多算法中都有重要的应用。虽然其实现相对复杂，但其优秀的性能使其成为算法设计中一个强大的工具。